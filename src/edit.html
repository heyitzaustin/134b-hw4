<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Edit a habit</title>
		<link rel="stylesheet" href="../css/forms.css">
	</head>
	<body>
		<script>
			function onStart() {
            	document.getElementById("icon3").style.border="5px solid #42A5F5";

            	var key = window.localStorage.getItem("habitKey");

            	var myFirebaseRef = new Firebase("https://torrid-fire-6209.firebaseio.com");
    			var habitsRef = myFirebaseRef.child("habits");

    			var valueRef = habitsRef.child(key);
    			valueRef.once("value", function(snapshot) {
  					var title = snapshot.child("title").val();
  					var daily = snapshot.child("dailyfrequency").val();
    				document.getElementById("title-top").value=title;
    				if(daily <= 3){
    					selectDay("day" + daily);
    				}
    				else{
    					document.getElementById("others").value = daily;
    				}
    			});

    			var weeklyRef = valueRef.child("weeklyfrequency");
    			weeklyRef.once("value", function(snapshot) {
  					var weekly = [];
  					weekly[0] = snapshot.child("sun").val();
  					weekly[1] = snapshot.child("mon").val();
  					weekly[2] = snapshot.child("tues").val();
  					weekly[3] = snapshot.child("wed").val();
  					weekly[4] = snapshot.child("thurs").val();
  					weekly[5] = snapshot.child("fri").val();
  					weekly[6] = snapshot.child("sat").val();
  					loadDate(weekly);
    			});
			}
			window.onload = onStart;
		</script>
		<div class="forms">
			<h2>Edit A Habit</h2>
			<form>
				<p><label><span id="title_text">Habit Title</span></label></p>
				<p><input id="title-top" type="text" name="fullname"></p>
				<p><label>Habit Icon</label></p>
				<img id="icon1" class="icon" onclick="selectImage('icon1');" src="../img/sleep.jpg" alt="sleep image"/>
				<img id="icon2" class="icon" onclick="selectImage('icon2');" src="../img/salad.jpg" alt="eat image"/>
				<img id="icon3" class="icon" onclick="selectImage('icon3');" src="../img/run.jpg" alt="run image"/>
				<img class="icon" src="../img/add.png" alt="find a image"/>
				<p><label>Weekly Frequency</label></p>
				<div id="ck-button">
					<label> <input type="checkbox" id="date0" name="date" value="sunday"><span>Sun</span></label>
					<label> <input type="checkbox" id="date1" name="date" value="monday"><span>Mon</span></label>
					<label> <input type="checkbox" id="date2" name="date" value="tuesday"><span>Tues</span></label>
					<label> <input type="checkbox" id="date3" name="date" value="wednesday"><span>Wed</span></label>
					<label> <input type="checkbox" id="date4" name="date" value="thursday"><span>Thur</span></label>
					<label> <input type="checkbox" id="date5" name="date" value="friday"><span>Fri</span></label>
					<label> <input type="checkbox" id="date6" name="date" value="saturday"><span>Sat</span></label>
				</div>
		
		
				<p><label>Daily Frequency</label></p>
				<div id="daily-button">
					<label> <input type="checkbox" id="day1" name="day" value="one" onclick="selectDay(this.id)"><span>1</span></label>
					<label> <input type="checkbox" id="day2" name="day" value="two" onclick="selectDay(this.id)"><span>2</span></label>
					<label> <input type="checkbox" id="day3" name="day" value="three" onclick="selectDay(this.id)"><span>3</span></label>
					<span id="times">times</span>
				</div>
				<p><label><span id="others_text">Others: </span><input id="others" type="text" name="day" placeholder="More than 3 times"></label></p>
				<p id="save_p"><input id="save" type="button" value="Save It" onclick="updateHabit(imageSelected);"></p>
				<label id="alert" style="color:red"></label>
			</form>

		</div>
		<script>
			var imageSelected;
			function selectImage(name) {
				//Clear all the other effects
				document.getElementById('icon1').style.border = "none";
				document.getElementById('icon2').style.border = "none";
				document.getElementById('icon3').style.border = "none";
				var image = document.getElementById(name);
				image.style.border = "5px solid #42A5F5";
				imageSelected = image;
			}

			function selectDay(id) {
    			for (var i=1; i<=3; i++) {
        			document.getElementById("day" + i).checked = false;
    			}
    			var day = document.getElementById(id);
    			if( day != null){
    				document.getElementById(id).checked = true;
    			}

			}

			function loadDate(array) {
				for (var i=0; i<7; i++) {
					document.getElementById("date" + i).checked = array[i];
				}
			}

			function toggleCheck(element) {
				//element.checked = !element.checked;
				//document.getElementById(id).checked = !document.getElementById(id).checked;
				//alert(document.getElementById(id).checked);
				//document.getElementById(id).checked = document.getElementById(id).checked ? false : true;
				if(element.checked){
					element.checked = false;
				}
				else{
					element.checked = true;
				}
			}
			
		</script>
		<script src="../js/CRUD.js"></script>
		<script src="../js/firebase.js"></script>
	</body>
</html>
